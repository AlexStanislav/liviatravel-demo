import{u as A,g as r,h as L,o as $,c as C,j as a,k as v,l as o,i as f,a as e,p as n,q as _,v as w,t as U,d as E,y as I,z as k}from"./index-7e309a1d.js";import{a as u,b as P,c as R}from"./column.esm-d1e5c47f.js";import{s as j,a as q}from"./confirmpopup.esm-34b2ebcc.js";const O={class:"table-header"},Z={class:"p-input-icon-left"},G=e("i",{class:"pi pi-search"},null,-1),H={class:"table-actions"},K={class:"form-row"},W={class:"form-column"},Y={class:"p-float-label"},J=e("label",{for:"title"},"Titlu",-1),Q={class:"p-float-label p-input-icon-right"},X=e("i",{class:"pi pi-euro"},null,-1),ee=e("label",{for:"price"},"Pret",-1),le={class:"form-column"},te={class:"p-float-label p-input-icon-left"},ae=e("i",{class:"pi pi-map-marker"},null,-1),oe=e("label",{for:"location"},"Locatie",-1),se={class:"p-float-label p-input-icon-left"},ie=e("i",{class:"pi pi-map-marker"},null,-1),ne=e("label",{for:"country"},"Tara",-1),ue={class:"form-row"},re={class:"form-column"},de={class:"p-float-label p-input-icon-left"},ce=e("i",{class:"pi pi-sun"},null,-1),pe=e("label",{for:"duration"},"Zile",-1),me={class:"p-float-label p-input-icon-left"},ve=e("i",{class:"pi pi-users"},null,-1),fe=e("label",{for:"adults"},"Locuri",-1),_e={class:"form-column"},be={class:"p-float-label p-input-icon-left"},he=e("i",{class:"pi pi-star"},null,-1),ge=e("label",{for:"rating"},"Stele",-1),Ve={class:"form-column"},Te={class:"p-float-label p-input-icon-left"},ye=e("i",{class:"pi pi-angle-double-right"},null,-1),$e=e("label",{for:"departure"},"Plecare",-1),Ce={class:"form-row"},we={class:"form-column"},Ue={class:"p-float-label p-input-icon-left"},ke=e("i",{class:"pi pi-angle-double-left"},null,-1),Be=e("label",{for:"arrival"},"Sosire",-1),Se={class:"form-column"},Fe={class:"p-float-label",style:{width:"100%"}},Me=e("label",{for:"description"},"Descriere",-1),xe={class:"image-upload"},De=["src"],ze={key:0,class:"file-info"},Ne=e("br",null,null,-1),Ae={class:"p-button p-button-success file-upload"},Le=e("i",{class:"pi pi-upload"},null,-1),Ee=e("span",{class:"p-button-label"},"Alege Imagine",-1),qe={__name:"ToursView",setup(Ie){const B=A(),T=r([]),s=r({}),d=r(!1),b=r(!1),c=window.location.origin,h=r({global:{value:null,matchMode:k.CONTAINS},title:{value:null,matchMode:k.STARTS_WITH}}),S=function(i,t=2){if(!+i)return"0 Bytes";const l=1024,V=t<0?0:t,N=["Bytes","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],y=Math.floor(Math.log(i)/Math.log(l));return`${parseFloat((i/Math.pow(l,y)).toFixed(V))} ${N[y]}`};function m(){f.get(`${c}/api/tours`).then(i=>{T.value=i.data})}L(()=>{m()});const p=r(null),g=r(""),F=i=>{const t=i.target.files[0],l=new FileReader;l.onload=()=>{g.value=l.result,p.value=t},l.readAsDataURL(t)},M=(i,t)=>{B.require({target:i.currentTarget,message:"Esti sigur ca vrei sa stergi acest circuit?",header:"Confirm",acceptClass:"p-button-danger",acceptLabel:"Da",rejectLabel:"Nu",icon:"pi pi-info-circle",accept:()=>{f.delete(`${c}/tours/${t.id}`).then(()=>{m()})}})},x=()=>{s.value={},d.value=!0,b.value=!1,g.value=""},D=i=>{s.value=i,b.value=!0,d.value=!0,g.value=i.img},z=i=>{if(i.preventDefault(),b.value===!0)f.put(`${c}/tours/${s.value.id}`,s.value).then(()=>{d.value=!1,b.value=!1,m()});else{s.value.img=`${c}/images/${p.value.name}`,f.post(`${c}/newTour`,s.value).then(l=>{d.value=!1,m()}).catch(l=>{console.log(l)});let t=new FormData;t.append("offerImage",p.value),f.post(`${c}/imageOffers`,t,{headers:{"Content-Type":"multipart/form-data"}}).then(l=>{l.status===200&&console.log("Success")}).catch(l=>{console.log(l)})}};return(i,t)=>($(),C("div",null,[a(o(P),{filters:h.value,"onUpdate:filters":t[3]||(t[3]=l=>h.value=l),value:T.value,paginator:"",rows:6,filterDisplay:"row",removableSort:""},{header:v(()=>[e("div",O,[e("span",Z,[G,a(o(n),{modelValue:h.value.global.value,"onUpdate:modelValue":t[0]||(t[0]=l=>h.value.global.value=l),placeholder:"Cautare globala"},null,8,["modelValue"])]),a(o(_),{icon:"pi pi-plus",class:"p-button-success",label:"Adauga circuit nou",onClick:t[1]||(t[1]=l=>x())}),a(o(_),{icon:"pi pi-refresh",class:"p-button-warning",label:"Actualizare",onClick:t[2]||(t[2]=l=>m())})])]),default:v(()=>[a(o(u),{field:"title",header:"Titlu"}),a(o(u),{field:"price",header:"Pret"}),a(o(u),{field:"country",header:"Tara"}),a(o(u),{field:"duration",header:"Durata"}),a(o(u),{field:"available",header:"Locuri"}),a(o(u),{field:"rating",header:"Stele"}),a(o(u),{field:"departure",header:"Plecare"}),a(o(u),{field:"arrival",header:"Sosire"}),a(o(u),null,{body:v(l=>[e("div",H,[a(o(_),{icon:"pi pi-pencil",class:"p-button-rounded p-button-success",onClick:V=>D(l.data)},null,8,["onClick"]),a(o(_),{icon:"pi pi-trash",class:"p-button-rounded p-button-danger",onClick:V=>M(V,l.data)},null,8,["onClick"])])]),_:1})]),_:1},8,["filters","value"]),a(o(I),{class:"tour-dialog",modal:"",visible:d.value,"onUpdate:visible":t[15]||(t[15]=l=>d.value=l),header:"Creeaza circuit"},{footer:v(()=>[a(o(_),{type:"submit",label:"Salveaza",class:"p-button-success",onClick:z})]),default:v(()=>[e("form",null,[e("div",K,[e("div",W,[e("span",Y,[a(o(n),{id:"title",modelValue:s.value.title,"onUpdate:modelValue":t[4]||(t[4]=l=>s.value.title=l)},null,8,["modelValue"]),J]),e("span",Q,[X,a(o(n),{id:"price",modelValue:s.value.price,"onUpdate:modelValue":t[5]||(t[5]=l=>s.value.price=l),type:"number"},null,8,["modelValue"]),ee])]),e("div",le,[e("span",te,[ae,a(o(n),{id:"location",modelValue:s.value.location,"onUpdate:modelValue":t[6]||(t[6]=l=>s.value.location=l)},null,8,["modelValue"]),oe]),e("span",se,[ie,a(o(n),{id:"country",modelValue:s.value.country,"onUpdate:modelValue":t[7]||(t[7]=l=>s.value.country=l)},null,8,["modelValue"]),ne])])]),e("div",ue,[e("div",re,[e("span",de,[ce,a(o(n),{id:"duration",modelValue:s.value.duration,"onUpdate:modelValue":t[8]||(t[8]=l=>s.value.duration=l)},null,8,["modelValue"]),pe]),e("span",me,[ve,a(o(n),{id:"adults",type:"number",modelValue:s.value.available,"onUpdate:modelValue":t[9]||(t[9]=l=>s.value.available=l)},null,8,["modelValue"]),fe])]),e("div",_e,[e("span",be,[he,a(o(n),{id:"rating",type:"number",min:1,max:5,modelValue:s.value.rating,"onUpdate:modelValue":t[10]||(t[10]=l=>s.value.rating=l)},null,8,["modelValue"]),ge])]),e("div",Ve,[e("span",Te,[ye,a(o(n),{id:"departure",modelValue:s.value.departure,"onUpdate:modelValue":t[11]||(t[11]=l=>s.value.departure=l)},null,8,["modelValue"]),$e])])]),e("div",Ce,[e("div",we,[e("span",Ue,[ke,a(o(n),{id:"arrival",modelValue:s.value.arrival,"onUpdate:modelValue":t[12]||(t[12]=l=>s.value.arrival=l)},null,8,["modelValue"]),Be]),a(o(R),{modelValue:s.value.type,"onUpdate:modelValue":t[13]||(t[13]=l=>s.value.type=l),options:["Intern","Extern"],placeholder:"Tip circuit"},null,8,["modelValue"])])]),e("div",Se,[e("span",Fe,[a(o(j),{id:"description",modelValue:s.value.description,"onUpdate:modelValue":t[14]||(t[14]=l=>s.value.description=l)},null,8,["modelValue"]),Me])])]),e("div",xe,[e("section",null,[e("img",{src:g.value,alt:""},null,8,De),p.value?($(),C("div",ze,[w(" Filename: "+U(p.value.name)+" ",1),Ne,w(" File size: "+U(S(p.value.size,2)),1)])):E("",!0)]),e("section",null,[e("div",Ae,[Le,Ee,e("input",{type:"file",onChange:F,accept:"image/*"},null,32)])])])]),_:1},8,["visible"]),a(o(q))]))}};export{qe as default};
