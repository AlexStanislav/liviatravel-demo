import{u as N,g as r,h as A,o as $,c as w,j as a,k as v,l as o,i as f,a as e,p as n,q as _,x as C,t as U,d as L,y as E,z as k}from"./index-89e6f598.js";import{a as u,b as I,c as P}from"./column.esm-0661068e.js";import{s as R,a as j}from"./confirmpopup.esm-2b6de71f.js";const q={class:"table-header"},O={class:"p-input-icon-left"},Z=e("i",{class:"pi pi-search"},null,-1),G={class:"table-actions"},H={class:"form-row"},K={class:"form-column"},W={class:"p-float-label"},Y=e("label",{for:"title"},"Titlu",-1),J={class:"p-float-label p-input-icon-right"},Q=e("i",{class:"pi pi-euro"},null,-1),X=e("label",{for:"price"},"Pret",-1),ee={class:"form-column"},le={class:"p-float-label p-input-icon-left"},te=e("i",{class:"pi pi-map-marker"},null,-1),ae=e("label",{for:"location"},"Locatie",-1),oe={class:"p-float-label p-input-icon-left"},se=e("i",{class:"pi pi-map-marker"},null,-1),ie=e("label",{for:"country"},"Tara",-1),ne={class:"form-row"},ue={class:"form-column"},re={class:"p-float-label p-input-icon-left"},de=e("i",{class:"pi pi-sun"},null,-1),ce=e("label",{for:"duration"},"Zile",-1),pe={class:"p-float-label p-input-icon-left"},me=e("i",{class:"pi pi-users"},null,-1),ve=e("label",{for:"adults"},"Locuri",-1),fe={class:"form-column"},_e={class:"p-float-label p-input-icon-left"},be=e("i",{class:"pi pi-star"},null,-1),he=e("label",{for:"rating"},"Stele",-1),ge={class:"form-column"},Ve={class:"p-float-label p-input-icon-left"},Te=e("i",{class:"pi pi-angle-double-right"},null,-1),ye=e("label",{for:"departure"},"Plecare",-1),$e={class:"form-row"},we={class:"form-column"},Ce={class:"p-float-label p-input-icon-left"},Ue=e("i",{class:"pi pi-angle-double-left"},null,-1),ke=e("label",{for:"arrival"},"Sosire",-1),Be={class:"form-column"},Se={class:"p-float-label",style:{width:"100%"}},xe=e("label",{for:"description"},"Descriere",-1),Fe={class:"image-upload"},Me=["src"],De={key:0,class:"file-info"},ze=e("br",null,null,-1),Ne={class:"p-button p-button-success file-upload"},Ae=e("i",{class:"pi pi-upload"},null,-1),Le=e("span",{class:"p-button-label"},"Alege Imagine",-1),je={__name:"ToursView",setup(Ee){const B=N(),T=r([]),s=r({}),d=r(!1),g=r(!1),c=window.location.origin,b=r({global:{value:null,matchMode:k.CONTAINS},title:{value:null,matchMode:k.STARTS_WITH}}),S=function(i,t=2){if(!+i)return"0 Bytes";const l=1024,h=t<0?0:t,z=["Bytes","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],y=Math.floor(Math.log(i)/Math.log(l));return`${parseFloat((i/Math.pow(l,y)).toFixed(h))} ${z[y]}`};function m(){f.get(`${c}/api/tours`).then(i=>{T.value=i.data})}A(()=>{m()});const p=r(null),V=r(""),x=i=>{const t=i.target.files[0],l=new FileReader;l.onload=()=>{V.value=l.result,p.value=t},l.readAsDataURL(t)},F=(i,t)=>{B.require({target:i.currentTarget,message:"Esti sigur ca vrei sa stergi acest circuit?",header:"Confirm",acceptClass:"p-button-danger",acceptLabel:"Da",rejectLabel:"Nu",icon:"pi pi-info-circle",accept:()=>{f.delete(`${c}/tours/${t.id}`).then(()=>{m()})}})},M=i=>{s.value=i,g.value=!0,d.value=!0,V.value=i.img},D=i=>{if(i.preventDefault(),g.value===!0)f.put(`${c}/tours/${s.value.id}`,s.value).then(()=>{d.value=!1,g.value=!1,m()});else{s.value.img=`${c}/images/${p.value.name}`,f.post(`${c}/newTour`,s.value).then(l=>{d.value=!1,m()}).catch(l=>{console.log(l)});let t=new FormData;t.append("offerImage",p.value),f.post(`${c}/imageOffers`,t,{headers:{"Content-Type":"multipart/form-data"}}).then(l=>{l.status===200&&console.log("Success")}).catch(l=>{console.log(l)})}};return(i,t)=>($(),w("div",null,[a(o(I),{filters:b.value,"onUpdate:filters":t[3]||(t[3]=l=>b.value=l),value:T.value,paginator:"",rows:6,filterDisplay:"row",removableSort:""},{header:v(()=>[e("div",q,[e("span",O,[Z,a(o(n),{modelValue:b.value.global.value,"onUpdate:modelValue":t[0]||(t[0]=l=>b.value.global.value=l),placeholder:"Cautare globala"},null,8,["modelValue"])]),a(o(_),{icon:"pi pi-plus",class:"p-button-success",label:"Adauga circuit nou",onClick:t[1]||(t[1]=l=>d.value=!0)}),a(o(_),{icon:"pi pi-refresh",class:"p-button-warning",label:"Actualizare",onClick:t[2]||(t[2]=l=>m())})])]),default:v(()=>[a(o(u),{field:"title",header:"Titlu"}),a(o(u),{field:"price",header:"Pret"}),a(o(u),{field:"country",header:"Tara"}),a(o(u),{field:"duration",header:"Durata"}),a(o(u),{field:"available",header:"Locuri"}),a(o(u),{field:"rating",header:"Stele"}),a(o(u),{field:"departure",header:"Plecare"}),a(o(u),{field:"arrival",header:"Sosire"}),a(o(u),null,{body:v(l=>[e("div",G,[a(o(_),{icon:"pi pi-pencil",class:"p-button-rounded p-button-success",onClick:h=>M(l.data)},null,8,["onClick"]),a(o(_),{icon:"pi pi-trash",class:"p-button-rounded p-button-danger",onClick:h=>F(h,l.data)},null,8,["onClick"])])]),_:1})]),_:1},8,["filters","value"]),a(o(E),{class:"tour-dialog",modal:"",visible:d.value,"onUpdate:visible":t[15]||(t[15]=l=>d.value=l),header:"Creeaza circuit"},{footer:v(()=>[a(o(_),{type:"submit",label:"Salveaza",class:"p-button-success",onClick:D})]),default:v(()=>[e("form",null,[e("div",H,[e("div",K,[e("span",W,[a(o(n),{id:"title",modelValue:s.value.title,"onUpdate:modelValue":t[4]||(t[4]=l=>s.value.title=l)},null,8,["modelValue"]),Y]),e("span",J,[Q,a(o(n),{id:"price",modelValue:s.value.price,"onUpdate:modelValue":t[5]||(t[5]=l=>s.value.price=l),type:"number"},null,8,["modelValue"]),X])]),e("div",ee,[e("span",le,[te,a(o(n),{id:"location",modelValue:s.value.location,"onUpdate:modelValue":t[6]||(t[6]=l=>s.value.location=l)},null,8,["modelValue"]),ae]),e("span",oe,[se,a(o(n),{id:"country",modelValue:s.value.country,"onUpdate:modelValue":t[7]||(t[7]=l=>s.value.country=l)},null,8,["modelValue"]),ie])])]),e("div",ne,[e("div",ue,[e("span",re,[de,a(o(n),{id:"duration",modelValue:s.value.duration,"onUpdate:modelValue":t[8]||(t[8]=l=>s.value.duration=l)},null,8,["modelValue"]),ce]),e("span",pe,[me,a(o(n),{id:"adults",type:"number",modelValue:s.value.available,"onUpdate:modelValue":t[9]||(t[9]=l=>s.value.available=l)},null,8,["modelValue"]),ve])]),e("div",fe,[e("span",_e,[be,a(o(n),{id:"rating",type:"number",min:1,max:5,modelValue:s.value.rating,"onUpdate:modelValue":t[10]||(t[10]=l=>s.value.rating=l)},null,8,["modelValue"]),he])]),e("div",ge,[e("span",Ve,[Te,a(o(n),{id:"departure",modelValue:s.value.departure,"onUpdate:modelValue":t[11]||(t[11]=l=>s.value.departure=l)},null,8,["modelValue"]),ye])])]),e("div",$e,[e("div",we,[e("span",Ce,[Ue,a(o(n),{id:"arrival",modelValue:s.value.arrival,"onUpdate:modelValue":t[12]||(t[12]=l=>s.value.arrival=l)},null,8,["modelValue"]),ke]),a(o(P),{modelValue:s.value.type,"onUpdate:modelValue":t[13]||(t[13]=l=>s.value.type=l),options:["Intern","Extern"],placeholder:"Tip circuit"},null,8,["modelValue"])])]),e("div",Be,[e("span",Se,[a(o(R),{id:"description",modelValue:s.value.description,"onUpdate:modelValue":t[14]||(t[14]=l=>s.value.description=l)},null,8,["modelValue"]),xe])])]),e("div",Fe,[e("section",null,[e("img",{src:V.value,alt:""},null,8,Me),p.value?($(),w("div",De,[C(" Filename: "+U(p.value.name)+" ",1),ze,C(" File size: "+U(S(p.value.size,2)),1)])):L("",!0)]),e("section",null,[e("div",Ne,[Ae,Le,e("input",{type:"file",onChange:x,accept:"image/*"},null,32)])])])]),_:1},8,["visible"]),a(o(j))]))}};export{je as default};
